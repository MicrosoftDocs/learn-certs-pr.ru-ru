### YamlMime:Course
title: Querying Data with Transact-SQL
metadata:
  title: 'Course 20761-C: Querying Data with Transact-SQL'
  description: 'Course 20761-C: Querying Data with Transact-SQL'
uid: course.20761
courseNumber: '20761-C'
hoursToComplete: 120
iconUrl: /media/learn/certification/course.svg
skillsGained:
- skill: Описать ключевые возможности и компоненты SQL Server.
- skill: Описать T-SQL, наборы и логику предикатов.
- skill: Написание однотабличного оператора SELECT.
- skill: Написание многотабличного оператора SELECT.
- skill: Написание операторов SELECT с фильтрацией и сортировкой.
- skill: Описать, как SQL Server использует типы данных.
- skill: Написание операторов DML.
- skill: Написание запросов, использующих встроенные функции.
- skill: Написание запросов, объединяющих данные.
- skill: Написание подзапросов.
- skill: Создание и реализация представлений и табличных функций.
- skill: Использование операторов множеств для объединения результатов запроса.
- skill: Написание запросов, использующих функции ранжирования, смещения и агрегирования окон.
- skill: Преобразование данных путем реализации pivot, unpivot, накопления и куба.
- skill: Создание и внедрение хранимых процедур.
- skill: Добавление в код T-SQL таких программных конструкций, как переменные, условия и циклы.
learningPartnersLink: https://www.microsoft.com/learning/partners.aspx
locales:
- en
levels:
- intermediate
roles:
- database-administrator
products:
- sql-server
exams:
- uid: exam.70-761
summary: |-
  Этот курс предназначен для ознакомления студентов с Transact-SQL. Он разработан таким образом, что первые три дня могут преподаваться в качестве курса для студентов, требующих знания для других курсов в учебной программе SQL Server. 4 и 5 дня, учат оставшимся навыками, необходимым для сдачи экзамена 70-761.

  #### Профиль аудитории
  Основная цель этого курса - дать студентам хорошее понимание языка Transact-SQL, который используется во всех дисциплинах, связанных с SQL Server; а именно, администрирование баз данных, разработка баз данных и бизнес-аналитика. Таким образом, основной целевой аудиторией для этого курса являются администраторы баз данных, разработчики баз данных и специалисты по BI.
prerequisitesSection: |-
  - Базовые знания об операционной системе Microsoft Windows и ее основных функциях.
  - Практические навыки работы с реляционными базами данных.
outlineSection: |-
  ### Модуль 1&#58; Введение в Microsoft SQL Server
  Этот модуль представляет SQL Server, версии SQL Server, включая облачные версии, и способы подключения к SQL Server с помощью SQL Server Management Studio.
  #### Уроки
  - Базовая архитектура SQL Server
  - Редакции и версии SQL Server
  - Начало работы с SQL Server Management Studio


  #### Лабораторная работа &#58; Работа с инструментами SQL Server
  - Работа с SQL Server Management Studio
  - Создание и организация сценариев T-SQL
  - Использование Books Online

  После завершения этого модуля вы сможете&#58; 
  - Описать реляционные базы данных и запросы Transact-SQL.
  - Описать локальные и облачные выпуски и версии SQL Server.
  - Описать, как использовать SQL Server Management Studio (SSMS) для подключения к экземпляру SQL Server, изучить базы данных, содержащиеся в этом экземпляре, и работать с файлами сценариев, которые содержат запросы T-SQL.


  ### Модуль 2&#58; Введение в запросы T-SQL
  Этот модуль описывает элементы T-SQL и их роль в написании запросов. Описание использование наборов в SQL Server. Описание использование логики предикатов в SQL Server. Описание логического порядка операций в инструкциях SELECT.


  #### Уроки
  - Введение в T-SQL
  - Понимание наборов данных
  - Понимание логики предиката
  - Понимание логического порядка операций в операторах SELECT


  #### Лабораторная работа &#58; Введение в T-SQL Querying
  - Выполнение базовых операторов SELECT
  - Выполнение запросов, фильтрующих данные с использованием предикатов
  - Выполнение запросов, сортирующих данные, используя ORDER BY

  После завершения этого модуля вы сможете&#58; 
  - Описать роль T-SQL в написании операторов SELECT.
  - Описать элементы языка T-SQL и какие элементы будут полезны при написании запросов.
  - Описать концепции теории множеств, одной из математических основ реляционных баз данных, и помочь применить ее к пониманию запросов к SQL Server.
  - Описать логику предиката и изучить его применение для запросов к SQL Server.
  - Объяснить элементы оператора SELECT, определить порядок, в котором оцениваются элементы, а затем применить это понимание к практическому подходу к написанию запросов.


  ### Модуль 3&#58; Написание запросов SELECT
  Этот модуль ознакомляет с основами оператора SELECT, сосредотачивая внимание на запросах к одинарной таблице.
  #### Уроки
  - Написание простых операторов SELECT
  - Устранение дубликатов с помощью DISTINCT
  - Использование псевдонимов столбцов и таблиц
  - Написание простых выражений CASE


  #### Лабораторная работа &#58; написание базовых операторов SELECT
  - Написание простых операторов SELECT
  - Удаление дубликатов с помощью DISTINCT
  - Использование псевдонимов столбцов и таблиц
  - Использование простого выражения CASE

  После завершения этого модуля вы сможете&#58; 
  - Описать структуру и формат оператора SELECT, а также усовершенствования, которые добавят функциональность и удобочитаемость вашим запросам.
  - Описать, как устранить дубликаты, используя предложение DISTINCT
  - Описать использование псевдонимов столбцов и таблиц
  - Понимать и использовать выражения CASE


  ### Модуль 4&#58; Запросы к нескольким таблицам
  Этот модуль описывает, как писать запросы, объединяющие данные из нескольких источников в Microsoft SQL Server.


  #### Уроки
  - Понимание JOINS
  - Запросы с внутренними JOINS
  - Запросы с внешними JOINS
  - Запросы с перекрестными и самостоятельными JOINS


  ####Лабораторная работа &#58; Запросы к нескольким таблицам
  - Написание запросов, которые используют внутренние соединения
  - Написание запросов, которые используют внутренние таблицы с несколькими таблицами
  - Написание запросов, использующих самостоятельные соединения
  - Написание запросов, использующих внешние соединения
  - Написание запросов, использующих перекрестные соединения

  После завершения этого модуля вы сможете&#58; 
  - Объяснить основы объединений в SQL Server 
  - Писать внутренние запросы соединения
  - Писать запросы, которые используют внешние соединения 
  - Использование дополнительных типов соединения


  ### Модуль 5&#58; Сортировка и фильтрация данных
  Этот модуль описывает, как реализовать сортировку и фильтрацию.
  #### Уроки
  - Сортировка данных
  - Фильтрация данных с помощью предикатов
  - Фильтрация данных с помощью TOP и OFFSET-FETCH
  - Работа с неизвестными значениями


  ####Лабораторная работа &#58; Сортировка и фильтрация данных
  - Написание запросов, фильтрующих данные, используя предложение WHERE
  - Написание запросов, сортирующих данные с помощью предложения ORDER BY
  - Написание запросов, фильтрующих данные с помощью опции TOP
  - Написание запросов, фильтрующих данные, используя предложение OFFSET-FETCH.

  После завершения этого модуля вы сможете&#58; 
  - Объяснить, как добавить предложение ORDER BY в ваши запросы, чтобы контролировать порядок строк, отображаемых в выходных данных вашего запроса.
  - Объяснить, как создавать предложения WHERE для фильтрации строк, которые не соответствуют предикату.
  - Объяснить, как ограничить диапазоны строк в предложении SELECT, используя опцию TOP. 
  - Объяснить, как ограничить диапазоны строк, используя опцию OFFSET-FETCH предложения ORDER BY.
  - Объяснить, как трехзначная логика учитывает неизвестные и пропущенные значения, как SQL Server использует NULL для пометки пропущенных значений и как проверить NULL в ваших запросах.

  ### Модуль 6&#58; Работа с типами данных SQL Server
  Этот модуль знакомит с типами данных, которые SQL Server использует для хранения данных.
  #### Уроки
  - Знакомство с типами данных SQL Server
  - Работа с символьными данными
  - Работа с данными даты и времени


  #### Лабораторная работа &#58; Работа с типами данных SQL Server
  - Написание запросов, возвращающих данные даты и времени
  - Написание запросов, использующих функции даты и времени
  - Написание запросов, возвращающих символьные данные
  - Написание запросов, возвращающих символьные функции

  После завершения этого модуля вы сможете&#58; 
  - Изучить многие типы данных, которые SQL Server использует для хранения данных, и способы преобразования типов данных между типами.
  - Объяснить символьные типы данных SQL Server, как работает сравнение символов и некоторые общие функции, которые могут оказаться полезными в ваших запросах.
  - Описать типы данных, которые используются для хранения временных данных, как ввести даты и время, чтобы они были правильно проанализированы SQL Server, и как управлять датами и временем с помощью встроенных функций.


  ### Модуль 7&#58; Использование DML для изменения данных
  Этот модуль описывает, как создавать запросы DML и зачем это нужно.
  #### Уроки
  - Добавление данных в таблицы
  - Изменение и удаление данных
  - Генерация автоматических значений столбцов


  #### Лабораторная работа&#58; использование DML для изменения данных
  - Вставка записей с помощью DML
  - Обновление и удаление записей с использованием DML

  После завершения этого модуля вы сможете&#58; 
  - Использовать операторы INSERT и SELECT INTO
  - Использовать UPDATE, MERGE, DELETE и TRUNCATE.


  ### Модуль 8&#58; Использование встроенных функций
  Этот модуль представляет некоторые из многих встроенных функций в SQL Server.
  #### Уроки
  - Написание запросов с использованием встроенных функций
  - Использование функций преобразования
  - Использование логических функций
  - Использование функций для работы с NULL


  ####Лабораторная работа &#58; Использование встроенных функций
  - Написание запросов, использующих функции преобразования
  - Написание запросов, использующих логические функции
  - Написание запросов, проверяющих на обнуляемость

  После завершения этого модуля вы сможете&#58; 
  - Описать типы функций, предоставляемых SQL Server, а затем сосредоточиться на работе со скалярными функциями.
  - Объяснить, как явно преобразовывать данные между типами, используя несколько функций SQL Server.
  - Описать, как использовать логические функции, которые оценивают выражение и возвращают скалярный результат.
  - Описать дополнительные функции для работы с NULL


  ### Модуль 9&#58; Группировка и агрегирование данных
  Этот модуль описывает, как использовать агрегатные функции.
  #### Уроки
  - Использование функций агрегирования
  - Использование оператора GROUP BY
  - Фильтрация групп с помощью HAVING


  ####Лабораторная работа &#58; Группировка и агрегирование данных
  - Написание запросов, использующих предложение GROUP BY
  - Написание запросов, использующих агрегатные функции
  - Написание запросов, использующих различные агрегатные функции
  - Написание запросов, фильтрующих группы с помощью предложения HAVING

  После завершения этого модуля вы сможете&#58; 
  - Описать встроенную агрегатную функцию в SQL Server и писать запросы с ее использованием.
  - Писать запросы, которые разделяют строки, используя предложение GROUP BY.
  - Писать запросы, которые используют предложение HAVING для фильтрации групп.


  ### Модуль 10&#58; Использование вторичных запросов
  Этот модуль описывает несколько типов подзапросов и как и когда их использовать.
  #### Уроки
  - Написание автономных вторичных запросов
  - Написание коррелированных вторичных запросов
  - Использование предиката EXISTS с вторичными запросами


  ####Лабораторная работа &#58; Использование вторичных запросов
  - Написание запросов, использующих автономные подзапросы
  - Написание запросов, использующих скалярные и многорезультатные подзапросы
  - Написание запросов, использующих коррелированные подзапросы и предложение EXISTS

  После завершения этого модуля вы сможете&#58; 
  - Описать, где в операторе SELECT могут использоваться подзапросы.
  - Писать запросы, использующие коррелированные подзапросы в операторе SELECT.
  - Писать запросы, использующие предикаты EXISTS, в предложении WHERE для проверки существования подходящих строк.
  - Использовать предикат EXISTS, чтобы эффективно проверять наличие строк во вторичном запросе.


  ### Модуль 11&#58; Использование табличных выражений
  Ранее в этом курсе вы узнали об использовании подзапросов в качестве выражения, возвращающего результаты во внешний запрос вызова. Как и подзапросы, табличные выражения являются выражениями запросов, но табличные выражения расширяют эту идею, позволяя вам давать им имена и работать с их результатами, как если бы вы работали с данными в любой допустимой реляционной таблице. Microsoft SQL Server поддерживает четыре типа табличных выражений; производные таблицы, общие выражения таблиц (CTE), представления и встроенные табличные функции (TVF). В этом модуле вы научитесь работать с этими формами табличных выражений и узнаете, как их использовать, чтобы помочь создать модульный подход к написанию запросов.
  #### Уроки
  - Использование представлений (видов)
  - Использование встроенных табличных функций
  - Использование производных таблиц
  - Использование общих табличных выражений


  ####Лабораторная работа &#58; Использование табличных выражений
  - Написание запросов, использующих представления
  - Написание запросов, использующих производные таблицы
  - Написание запросов с использованием общих табличных выражений (CTE)
  - Написание запросов, использующих встроенные табличные выражения (TVF)

  После завершения этого модуля вы сможете&#58; 
  - Писать запросы, которые возвращают результаты из просмотров.
  - Использовать оператор CREATE FUNCTION для создания простых встроенных TVF.
  - Писать запросы, которые создают и извлекают результаты из производных таблиц.
  - Писать запросы, которые создают CTE и возвращают результаты из табличного выражения.


  ### Модуль 12&#58; Использование операторов наборов данных
  В этом модуле рассказывается, как использовать операторы множеств UNION, INTERSECT и EXCEPT для сравнения строк между двумя входными наборами.
  #### Уроки
  - Написание запросов с оператором UNION
  - Использование EXCEPT и INTERSECT
  - Использование APPLY

  
  ####Лабораторная работа &#58; Использование операторов наборов данных
  - Написание запросов, использующих операторы множеств UNION и UNION ALL
  - Написание запросов, использующих операторы CROSS APPLY и OUTER APPLY
  - Написание запросов. использующих операторы EXCEPT и INTERSECT

  После завершения этого модуля студенты смогут следующее&#58;
  - Писать запросы, использующие UNION для объединения входных наборов.
  - Писать запросы, использующие UNION ALL для объединения входных наборов
  - Писать запросы, использующие оператор EXCEPT для возврата только строк в одном наборе, а не в другом.
  - Писать запросы, использующие оператор INTERSECT, чтобы возвращать только те строки, которые присутствуют в обоих наборах
  - Писать запросы, используя оператор CROSS APPLY.
  - Писать запросы с использованием оператора OUTER APPLY


  ### Модуль 13&#58; Использование функций ранжирования, смещения и агрегирования Windows
  Этот модуль описывает преимущества использования оконных функций. Ограничение оконных функций строками, определенными в предложении OVER, включая разделы и фреймы. Написание запросов, использующих оконные функции для работы с окном строк и возвращают результаты ранжирования, агрегирования и сравнения смещений.
  #### Уроки
  - Создание окон с помощью OVER
  - Изучение оконных функций


  #### Лабораторная работа &#58; Использование функций ранжирования, смещения и агрегирования Windows
  - Написание запросов, использующих функции смещения
  - Написание запросов, использующих функции агрегирования окон
  - Написание запросов, использующих функции ранжирования

  После завершения этого модуля студенты смогут следующее&#58;
  - Описать компоненты T-SQL, используемые для определения окон, и отношения между ними.
  - Писать запросы, использующие предложение OVER, с разбиением, упорядочением и кадрированием для определения окон
  - Писать запросы, использующие функции агрегатирования окон.
  - Писать запросы, использующие функции ранжирования окон.
  - Писать запросы, использующие функции смещения окна


  ### Модуль 14&#58; Наборы сведения и группировки
  Этот модуль описывает запросы записи, которые сводят и отменяют наборы результатов. Написание запросов, которые определяют несколько группировок с помощью групповых наборов
  #### Уроки
  - Написание запросов с PIVOT и UNPIVOT
  - Работа с группировками данных


  ####Лабораторная работа &#58; Наборы сведения и группировки
  - Написание запросов с использованием оператора PIVOT
  - Написание запросов, использующих оператор UNPIVOT
  - Написание запросов, использующих подразделы GROUPING SETS CUBE и ROLLUP.

  После завершения этого модуля студенты смогут следующее&#58;
  - Описание того, как сводные данные могут использоваться в запросах T-SQL.
  - Писать запросы, сводящие данные из строк в столбцы, используя оператор PIVOT.
  - Писать запросы, отменяющие вывод данных из столбцов обратно в строки, используя оператор UNPIVOT.
  - Писать запросы с использованием подраздела GROUPING SETS.
  - Писать запросы, использующие ROLLUP AND CUBE.
  - Писать запросы, использующие функцию GROUPING_ID.


  ### Модуль 15&#58; Выполнение хранимых процедур
  Этот модуль описывает, как вернуть результаты, выполняя хранимые процедуры. Передача параметров процедурам. Создание простых хранимых процедур, инкапсулирующих инструкцию SELECT. Создание и выполнение динамический SQL с EXEC и sp_executesql.
  #### Уроки
  - Запрос данных с помощью хранимых процедур
  - Передача параметров в хранимые процедуры
  - Создание простых хранимых процедур
  - Работа с динамическим SQL


  #### Лабораторная работа &#58; выполнение хранимых процедур
  - Использование оператора EXECUTE для вызова хранимых процедур
  - Передача параметров в хранимые процедуры
  - Выполнение системных хранимых процедур

  После завершения этого модуля студенты смогут следующее&#58;
  - Описать хранимые процедуры и их использование.
  - Писать операторы T-SQL, выполняющие хранимые процедуры для возврата данных.
  - Писать операторы EXECUTE, передающие входные параметры хранимым процедурам.
  - Писать пакеты T-SQL, которые подготавливают выходные параметры и выполняют хранимые процедуры.
  - Использовать оператор CREATE PROCEDURE, чтобы написать хранимую процедуру.
  - Создать хранимую процедуру, которая принимает входные параметры.
  - Описать, как можно динамически построить T-SQL.
  - Писать запросы, использующие динамический SQL.


  ### Модуль 16&#58; Программирование с помощью T-SQL
  Этот модуль описывает, как улучшить ваш код T-SQL с помощью элементов программирования.
  #### Уроки
  - Элементы программирования T-SQL
  - Управление программным потоком


  ####Лабораторная работа &#58; Программирование с помощью T-SQL
  - Объявление переменных и разделение пакетов
  - Использование элементов управления потоком
  - Использование переменных в динамическом операторе SQL
  - Использование синонимов

  После завершения этого модуля студенты смогут следующее&#58;
  - Описать, как Microsoft SQL Server рассматривает наборы операторов как пакеты.
  - Создавать и отправлять пакеты кода T-SQL для выполнения SQL Server.
  - Описать, как SQL Server хранит временные объекты в виде переменных.
  - Писать код, который объявляет и присваивает переменные.
  - Создавать и вызывать синонимы
  - Описать элементы управления потоком в T-SQL.
  - Написать код T-SQL, используя блоки IF ELSE.
  - Написать код T-SQL, который использует WHILE.


  ### Модуль 17&#58; Реализация обработки ошибок
  Этот модуль знакомит с обработкой ошибок для T-SQL.
  #### Уроки
  - Реализация обработки ошибок T-SQL
  - Реализация структурированной обработки исключений


  ####Лабораторная работа &#58; Реализация обработки ошибок
  - Перенаправление ошибок с TRY/CATCH
  - Использование THROW для передачи сообщения об ошибке клиенту

  После завершения этого модуля студенты смогут следующее&#58;
  - Реализовать обработку ошибок T-SQL.
  - Реализовать структурированную обработку исключений.


  ### Модуль 18&#58; Реализация транзакций
  Этот модуль описывает, как реализовать транзакции.
  #### Уроки
  - Транзакции и базы данных двигателей
  - Контроль транзакций


  ####Лабораторная работа &#58; Реализация транзакций
  - Контроль транзакций с помощью BEGIN, COMMIT и ROLLBACK
  - Добавление обработки ошибок в блок CATCH

  После завершения этого модуля студенты смогут следующее&#58;
  - Описывать транзакции и различия между пакетами и транзакциями.
  - Описывать пакеты и как они обрабатываются SQL Server.
  - Создавать транзакции и управлять ими с помощью операторов языка управления транзакциями (TCL).
  - Использовать SET XACT_ABORT для определения обработки SQL-серверами транзакций вне блоков TRY/CATCH.

